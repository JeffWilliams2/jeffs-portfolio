---
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import PageHead from '@/components/PageHead.astro'
import Search from '@/components/react/search'
import PaginationComponent from '@/components/ui/pagination'
import Layout from '@/layouts/Layout.astro'
import { getAllPosts } from '@/lib/data-utils'
import type { PaginateFunction } from 'astro'
import { Icon } from 'astro-icon/components'

export async function getStaticPaths({
  paginate,
}: {
  paginate: PaginateFunction
}) {
  const allPosts = await getAllPosts()
  return paginate(allPosts, { pageSize: 5 })
}

const { page } = Astro.props
const searchList = await getAllPosts()
const currentUrl = Astro.url;
---

<Layout canonicalUrl={currentUrl}>
  <PageHead slot="head" title="Blog" />
  
  <section class="max-w-3xl mx-auto px-6 py-20">
    <h1 class="text-4xl font-normal mb-6 text-zinc-900 dark:text-zinc-100">Blog</h1>
    <p class="text-zinc-600 dark:text-zinc-400 text-base max-w-2xl mb-12">
      Notes on data engineering, cloud architecture, and building production systems. Focused on practical patterns and lessons learned.
    </p>

    <div class="mb-16">
      <Search client:load searchList={searchList} initialPosts={page.data} />
    </div>

    <div class="mt-12">
      <PaginationComponent
        currentPage={page.currentPage}
        totalPages={page.lastPage}
        baseUrl="/blog/"
        client:load
      />
    </div>
  </section>
</Layout>
